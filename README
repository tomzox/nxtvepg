Hi there,

In this software package you find a decoder for Nextview EPG - an Electronic
TV Programme Guide for the analog domain (as opposed to the various digital
EPGs that come with most digital broadcasts). It allows you to receive and
browse TV programme listings for most of the major networks in Germany,
Austria, France, Belgium and Switzerland.

As of December 2007 Nextview EPG is transmitted by:
- in Germany and Austria: Kabel1 (coverage: apx. 32 networks)
- in Switzerland: SF1, TSR1, TSI1, TV5 (coverage: apx. 37 networks)
- in France: Canal+, M6, TV5 (coverage: 8 networks)
- in Belgium: M6, TV5 (coverage: 32 networks)
- in Turkey: TRT family (coverage: apx. 17 networks)

If you don't receive any of those, then this software unfortunately is
almost useless to you, except for the possibility to acquire EPG data
from teletext and external sources via XMLTV (but those are mainly
designed to accompany Nextview EPG so they won't work very well
stand-alone.)  For more details on pre-requesites please refer to
the documentation in the "Help" menus and manual page.

The Nextview standard was developed by the major European consumer electronics
manufacturers under the hood of the European Telecommunications Standards
Institute (http://www.etsi.org/) in 1995-1997 and is freely available as
standard number ETS 300 707. The author of this software has no connections
whatsoever to the ETSI - but he still hopes this software distribution will
be kindly tolerated.

nxtvepg is freeware, licensed under the GNU Public License 2. See file
COPYRIGHT for details.


System requirements:

Hardware minimum requirements are a PC or workstation with performance
equivalent to a 90 MHz Intel Pentium CPU and 128 MB of RAM (note nxtvepg
is also known to work fine on Power-PC and Ultra-Sparc platforms.)
Additionally an analog TV tuner card is required. In some cases you
may also be able to use a DVB card as input, see below.

The Windows version supports all PCI TV cards based either on the capture
chips Brooktree Fusion Bt878/Bt848, sucessor Conexant CX23881 or
Philips SAA7134 via the internal "dsdrv4" driver (which is taken from
the DScaler project.)  With the help of an external DLL (currently not
included - please refer to the download page) additionally all cards
which come with a WDM Driver which supports "VBI" decoding (e.g. teletext)
are supported.

The Linux version supports all cards for which a "video4linux" or v4l2
compatible driver exists (e.g. bttv, saa7134, cx8800, possibly even USB
TV boxes.)  NetBSD and FreeBSD versions supports all cards which are
supported by the bktr driver.

Linux software requirements:
- for bttv kernel >= 2.0.35 (2.0.x was prone to freezes with bttv though,
  hence upgrade to at least 2.2.x is highly recommended)
- SAA7134 and CX23881 cards require at least kernel 2.4.x plus some v4l2
  kernel patches (your Linux distribution may already include those if it
  comes with saa7134 support), see http://www.bytesex.org/; alternatively
  use kernel 2.6.2 or later, which works without patches.
- video4linux and bttv drivers, bttv version >= 0.7.55 recommended;
  saa7134 version >= 0.2.9 required; cx88xx driver (for cards with Conexant
  CX23881 aka Bt881 capture chip) has no official release as of writing this,
  use snapshot video4linux-20040330 or later from http://www.bytesex.org/
- GNU C Compiler 2.93.3 or later, unless you got nxtvepg precompiled for
  your platform. As of nxtvepg 2.9 a C++ compiler is required to compile
  the teletext grabber (optional); This has only been tested with gcc-4.3.3
- Tcl/Tk version 8.4 or later (version 8.5 recommended due to improvements
  in appearance.) Sources available for download from http://www.tcl.tk/
- Any release of X11R5 or X11R6
  Note: X11 and Tcl/Tk are not required if you only build the daemon

NetBSD software requirements:
- kernel >= 1.5 including the bktr driver 2.17 or later,
  available from http://vulture.dmem.strath.ac.uk/bt848/
- GNU C Compiler, unless you got nxtvepg in a precompiled NetBSD package
- Tcl/Tk version 8.4 or later
  Sources available for download from http://www.tcl.tk/
- Any release of X11R5 or X11R6
  Note: X11 and Tcl/Tk are not required if you only build the daemon

Windows software requirements:
- Nothing actually: nxtvepg is shipped with all the required components.
- Exception for Windows 95: the winsock2 DLL is required (ws2_32.dll, for
  the daemon feature) which - in contrary to newer Windows versions - was
  not included with this OS.
- Supported OS: Windows NT, Windows 2000, Windows XP, Windows 95/98/ME.
- On Windows NT/2000/XP you need to run nxtvepg under an account with
  special privileges (you must be allowed to install and start a service)
  unless you use a DirectShow source (i.e. WDM driver; requires DirectX 9)
- Exception for unsupported hardware: If the internal driver doesn't
  recognize your card or fails to load data, you may obtain the external
  VbiAcqWdmDrv.dll which allows to address your TV card via the vendor's
  WDM driver. This DLL is available separately at the nxtvepg homepage.


UNIX installation procedure (when compiling from source):

- Recommended: first install a TV application like "xawtv" to make sure
  sure your drivers work correctly.

- There's currently no "configure" script, so you have to manually check
  path definitions at the top of the Makefile, esp. for the Tcl/Tk libraries,
  include path and script libraries.

- There are also several compile-time options in the Makefile which you
  might want to consider, however the defaults should work everywhere.

- If you compile on a non-supported operating system or if you don't have a
  TV card or a supported driver, then replace epgvbi/btdrv4linux with module
  epgvbi/btdrv4dummy in the Makefiles (you still can use network acquisition
  mode to receive data from a supported platform)

- As of nxtvepg-2.9 you need package "libboost-regex-dev", i.e. the Boost
  regular expression library and header files. You can get it either
  pre-compiled via "apt-get" or the package manager of your choice, or
  directly from http://www.boost.org/.  You can remove compile-switch
  "USE_TTX_GRABBER" in the Makefile to avoid this dependency.

- make
  + Note: typing "make nxtvepg" will not work since there are other targets
    which need to be built first.  Hence just start make without parameters.
  + If compilation fails with massive syntay errors, check the type
    definitions in epgctl/mytypes.h first.  Required types are: bool,
    schar, uchar, sint, uint, slong, ulong.  Compilation may fail if these
    are already defined in system header files; in this case you probably
    have to comment out nxtvepg's definition.
  + If compilation fails due to missing "include files", you probably lack
    development versions of standard libraries. On Debian/Ubuntu you need:
    apt-get install tcl8.4 tcl8.4-dev tk8.4 tk8.4-dev
    apt-get install libx11-dev libxmu6 libxmu-dev
  + To build the "nxtvepgd" executable type "make daemon" or "make all".
    This will compile one extra module and otherwise just link a smaller
    executable which does not contain the graphical user interface.
  + To compile the tvsim test & development suite too, invoke "make all"
    (Note these tools are not installed into system directories since they
    are intended for temporary use in debugging only.)
  + Intermediate objects and the binaries are generated in a subdirectory
    named build-<platform> (e.g. build-i386 for an Intel compatible)

- make install
  This will copy the nxtvepg and nxtvepgd executables and their respective
  manual pages into system directories and set up a directory where the
  databases are stored.  Usually you need to "su root" to have permission
  to do so.

- Invoke the application and start a provider scan from the Configure menu.
  Alternatively, tune a Nextview provider's TV channel with a TV application
  (see provider list at the top of this file) and let nxtvepg run in parallel,
  it should automatically pick up incoming Nextview EPG data.  Further
  details can be found in the man page or help menu, section "Getting Started"

If the GUI shows up but does not react to any input, you probably
need to tell Tcl/Tk where to find it's libraries. To do so, correct
the paths in TCL_LIBRARY_PATH and TK_LIBRARY_PATH in the Makefile.
If you need to change anything besides the Makefile, please let me
know about it (i.e. send me the diffs)


Windows installation procedure:

- Unpack the zip file into an empty directory.

- Make sure you've stopped your TV viewing application and any other
  video applications.  (You always need to do this before you start
  nxtvepg, because only one application may use the TV card at the
  same time.  Should you accidentially start a 2nd one, terminate both
  before you continue to use either of them)

- Invoke the executable nxtvepg.exe
  If there are any warning or error popup messages from the TV card
  driver, please refer to the list below.

- Set up the driver in the "TV card input" menu.  There's extensive
  help available in the documentation, sections "Getting Started" and
  "Configuration: TV card input"

- Start an EPG scan. If the scan just runs through without finding any
  network IDs, check your TV card settings (after checking your antenna
  cable) and try again.  If the scan still fails, there are two other
  possibilities for Nextview reception:
  1: Set acquisition mode "external". Then stop acquisition and tune in a
  provider channel with a separate application, e.g. a TV viewer. Then quit
  the other application again and start acquisition. See 'Getting Started'
  and the help for the acquisition mode dialog for more information.
  2: Alternatively you can try an external input, i.e. supply a provider's
  TV channel via the Composite inputs, e.g. from your VCR.
  Note: if the scans fails to identify a subset of channels (i.e. "no CNI
  received" for a number of consecutive channels) you may have selected a
  wrong tuner type. But also note that not all channels do send CNI data
  (most notably MTV and local TV channels.)


Compilation procedure for Windows

- Note this is NOT required for regular users, only if you want to
  change the software!
- The source package as provided in the release distributions does not
  contain the Tcl/Tk libraries (DLLs).  You can simply copy those from
  the Windows binary package into the source root directory.  You could
  also use the original DLLs as available from http://www.tcl.tk/,
  but you'd miss a few patches (see README.tcl*; patches were made
  (1) to catch shutdown messages (2) to disable use of the Windows
  MessageBox() in tk_messageBox because it crashed the program and
  (3) to insert the nxtvepg icon).  Note that prior to nxtvepg-2.5.0
  the sources also lacked the tcl/tk script libraries; these are
  available on request.
- Fastest way is to cross-compile for Windows under Linux.  You need to
  install "mingw32" package and then type "make -f Makefile.win"
- Alternatively you can install GNU/Cygwin on your Windows host, see
  http://www.cygwin.com/  Most important are packages for make, gcc,
  mingw ("Minimalistic GNU for Windows") and win32 header files.  After
  installing Cygwin, start a shell, cd to the nxtvepg directory and type
  "make".  If you're not using NT or W2K you may have to adapt the OS
  detection code in Makefile and/or Makefile.win, i.e.
  "ifeq ($(OS),Windows_NT)"
- To compile the teletext grabber, the Boost regex library is required.
  Get the sources from http://www.boost.org/ and compile them for
  Windows. Note only library v 1.42 has been tested. Place the compiled
  library into the boost/ sub-directory.
- To generate the help menus from the documentation in POD format you
  need Perl5 (not essential unless you want to modify the help menus)
  from http://www.perl.org/ or as Cygwin package
- If you want to compile the driver you should refer to the DScaler
  documentation at http://www.dscaler.org/


Explanation of Windows TV card driver error messages:

- "Failed to load the TV card driver. (...)"
  This message can unfortunately have many causes. For the most probable
  causes an explanation is appended to the message.  The following hints
  may help you:

  1. You may not have the driver files "dsdrv4.sys" and "dsdrv4.vxd"
  in the working directory of nxtvepg. This may happen if you specify
  a working directory (e.g. in a shortcut definition) that differs from
  the one that contains the nxtvepg.exe. Don't do that, use the -dbdir
  and -rcfile options instead to specify where configuration files are
  searched for.

  2. On Windows NT and Windows 2000 you need to have administrator privileges
  the very first time you start nxtvepg, to be able to install the TV card
  driver.  The driver attempts to set up permissions in a way that afterwards
  every user can start its "DsDrv4" service. However if that fails (the causes
  for failure are still under investigation; all feedback is appreciated) you
  need to have special privileges to start the driver: on NT you must be
  in the Administrator group, on W2K and XP you need "Power user" status
  (also called "main user").

  3. You're using driver files of a wrong version.  You must use the version
  that comes with nxtvepg or a newer version.  nxtvepg attempts to upgrade
  the driver automatically to the required version, but that may fail if the
  service cannot be stopped (e.g. other application still using it) or
  permissions don't allow to remove the service.

  Note: to force windows to use the new driver version which comes with
  nxtvepg, you can remove or rename all other files named dsdrv4.sys
  and dsdrv4.vxd on your harddisk.  Because usually Windows does not use
  the drivers in the current directory if a driver path was previously
  stored in the registry (e.g. during installation of another application
  which is based in dsdrv4)

  4. You're starting nxtvepg from a network drive:  this is not allowed
  for reasons of stability.  Move the nxtvepg directory onto a local
  drive (e.g. C:)

  5. The "DSdrv4" service entry in the registry may be messed up.
  You can remove all keys that match "dsdrv4". Note:  you should delete
  not only those in the CurrentControlSet, but those in all control sets.
  Only required in exceptional cases.

  If none of these seem to be the cause, you can enable logging to a
  file in the "TV card input" dialog in the Configure menu.  The log
  file "dsdrv.log" is created in the nxtvepg working directory.  If you
  don't get the driver to work, feel free to mail the log file and
  a dump of the dsdrv4 service registry entry (using "regedit") to me.

- "No supported capture cards found on PCI bus"
  Nxtvepg scans the PCI bus for devices with certain vendor and device
  codes which are specific to every video capture chip.  If your TV card
  is not detected, this means it's either not connected to the PCI bus
  or it's using an unsupported chip version.  If your card is supported
  by another freeware app, you can mail me and I'll see if I can support
  it in nxtvepg, too.

- "Capture card #%d not found (found %d cards)"
  If there's at least one card found, lower the card index below the
  number of available cards, i.e. if you have two cards, specify index
  0 or 1. The card index can be given either on the command line with
  the -card option or in the "TV card input" configuration dialog.

- "Capture card #x (with <X> chip) cannot be locked!",
  There may be a different application already using the TV card. On
  M$ Windows you cannot run, e.g. a TV application in parallel to
  nxtvepg (unless the TV app supports interaction with nxtvepg) or
  teletext decoders (if you have only one TV card).

- "Warning: no tuner found on TV card I2C bus"
  No tuner was found during the I2C bus scan.  Currently nxtvepg supports
  only generic tuner chips.  Some cards (e.g. from Pinnacle) have very
  exotic tuners which need special care.  Currently you can only use these
  by selection "external" acquisition mode and using a TV app to tune the
  channel (make sure to terminate the TV app before you start nxtvepg)

- "Failed to allocate RISC code memory",
  "Failed to allocate DMA page table memory" or
  "VBI Memory for DMA not Allocated". These mesages mean that the kernel
  could not allocate RAM for data transfers from the TV card. Reboot and
  try again, this should normally not happen because the amount of memory
  which is allocated is relatively small (in comparison to the amount a
  TV application would require to transfer image data.)

- "Capturing is already enabled in the TV card"
  Only one video application may use the TV card at the same time. nxtvepg
  will refuse to start acquisition if capturing is already enabled to
  prevent interfering with an on-going DMA transfer and possibly crashing
  your system.

Before you mail me, please try to get DScaler to work (www.dscaler.org)
nxtvepg's Win32 driver handling is heavily based upon that software.
Since I'm not a M$ Windows software developer my understanding of Windows
specific problems is rather limited.



Problem and bug reports:

Before you email me any bug reports, please check the manual page as well
as the TODO and CHANGES files. And be *comprehensive* in describing your
problem. At least include names and version numbers of your operating system,
nxtvepg, possibly the bttv driver and any other software that may be
involved. If it looks like a hardware related problem (e.g. acquisition
does not work at all) also include the exact name of you TV card hardware.
If DScaler or K!TV work with the same hardware, mail me the version number and
describe your hardware configuration settings. If there is an error message,
quote the message in full length and exactly as printed, even if you do not
understand its relevance.

In case nxtvepg crashes, or if you suspect internal errors, you need to
recompile with debug support to allow me to analyze the problem.  Please
add the -g option to CFLAGS in the Makefile and enable all debug options in
mytypes.h by assigning ON instead of OFF. If you know which modules are
responsible, you can also comment out DPRINTF_OFF at the top of those
modules. Then try to reproduce your problem and send me the resulting
debug.out log file.


The latest version of this software is available at:
http://nxtvepg.sourceforge.net/

Best way to provide feedback is via the discussion forum at the above site,
but you can also contact me personally at: tomzo (at) users.sourceforge.net

have fun.

-tom
